---
import BaseLayout from '../../layouts/BaseLayout.astro'
import Icon from '../../components/Icon.astro'
import { getAllBlogPosts } from '../../lib/blog'

const allPosts = await getAllBlogPosts()

const formatDate = (date: Date) => {
  return new Intl.DateTimeFormat('fr-FR', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
  }).format(date)
}
---

<BaseLayout
  title="Blog Web & SEO pour commerces locaux | Loire Digital"
  description="Guides pratiques pour commerces de Saint-Etienne : ameliorer son SEO local, creer son site web, optimiser sa presence digitale. Conseils concrets et actionnables."
>
  <!-- Hero -->
  <section class="relative py-24 md:py-32 section-white">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto text-center">
        <span class="text-elegant-caps text-or tracking-widest mb-4 block">Ressources & Conseils</span>
        <h1 class="section-title text-5xl md:text-7xl mb-6">
          Blog
        </h1>
        <div class="separator-gold-center mt-6 mb-6"></div>
        <p class="section-subtitle mx-auto">
          Conseils, guides et actualites pour developper votre presence en ligne et faire grandir
          votre commerce a Saint-Etienne.
        </p>
      </div>
    </div>
  </section>

  <!-- Blog Posts -->
  <section class="py-16 md:py-20 section-creme">
    <div class="container mx-auto px-4">
      <div class="max-w-5xl mx-auto">
        {
          allPosts.length === 0 ? (
            <div class="text-center py-20">
              <p class="text-charbon text-lg">Aucun article pour le moment. Revenez bientot !</p>
            </div>
          ) : (
            <div class="grid grid-cols-1 gap-12">
              {allPosts.map((post) => (
                <article class="card-elegant flex flex-col md:flex-row gap-8 group">
                  {/* Post Image/Icon */}
                  <div class="md:w-72 flex-shrink-0">
                    <div class="aspect-video bg-creme border border-gris-doux rounded-elegant flex items-center justify-center overflow-hidden">
                      {post.image ? (
                        <img
                          src={post.image}
                          alt={post.title}
                          class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
                          loading="lazy"
                        />
                      ) : (
                        <div class="text-center p-6">
                          <div class="icon-container icon-container-lg mx-auto mb-4">
                            {post.tags.includes('SEO') ? (
                              <Icon name="search" class="icon-gold" size={32} />
                            ) : post.tags.includes('tarifs') ? (
                              <Icon name="price-tag" class="icon-gold" size={32} />
                            ) : post.tags.includes('commerce local') ? (
                              <Icon name="storefront" class="icon-gold" size={32} />
                            ) : (
                              <Icon name="document-text" class="icon-gold" size={32} />
                            )}
                          </div>
                          <p class="text-or font-serif font-semibold text-sm">
                            {post.title.split(' ').slice(0, 3).join(' ')}
                          </p>
                        </div>
                      )}
                    </div>
                  </div>

                  {/* Post Content */}
                  <div class="flex-1">
                    <div class="flex flex-wrap gap-2 mb-3">
                      {post.tags.map((tag: string) => (
                        <span class="text-xs bg-or/10 text-or px-3 py-1 rounded-full font-semibold capitalize">
                          {tag}
                        </span>
                      ))}
                    </div>

                    <h2 class="text-2xl md:text-3xl font-serif font-bold text-noir mb-3 group-hover:text-or transition-colors">
                      <a href={`/blog/${post.slug}`}>{post.title}</a>
                    </h2>

                    <div class="flex items-center text-sm text-charbon mb-4">
                      <svg
                        class="w-4 h-4 mr-2 text-or"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="1.5"
                          d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                        />
                      </svg>
                      <time datetime={post.pubDate.toISOString()}>
                        {formatDate(post.pubDate)}
                      </time>
                      <span class="mx-2 text-or">|</span>
                      <span>{post.author}</span>
                    </div>

                    <p class="text-charbon mb-6 leading-relaxed">{post.description}</p>

                    <a
                      href={`/blog/${post.slug}`}
                      class="inline-flex items-center text-or font-semibold hover:text-or-light group/link"
                    >
                      Lire l'article complet
                      <svg
                        class="w-5 h-5 ml-2 group-hover/link:translate-x-1 transition-transform"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M17 8l4 4m0 0l-4 4m4-4H3"
                        />
                      </svg>
                    </a>
                  </div>
                </article>
              ))}
            </div>
          )
        }
      </div>
    </div>
  </section>

  <!-- Newsletter -->
  <section class="py-16 md:py-24 section-white">
    <div class="container mx-auto px-4">
      <div class="max-w-3xl mx-auto text-center">
        <span class="text-elegant-caps text-or tracking-widest mb-4 block">Newsletter</span>
        <h2 class="section-title">
          Restez informe
        </h2>
        <div class="separator-gold-center mt-6 mb-6"></div>
        <p class="section-subtitle mx-auto mb-8">
          Recevez nos meilleurs conseils pour developper votre commerce en ligne directement dans
          votre boite mail.
        </p>
        <form class="flex flex-col sm:flex-row gap-4 max-w-md mx-auto">
          <input
            type="email"
            placeholder="votre@email.fr"
            class="flex-1 px-6 py-3 bg-white border border-gris-doux rounded-elegant text-noir placeholder-gris-moyen focus:ring-2 focus:ring-or focus:border-or outline-none transition-all"
            required
          />
          <button type="submit" class="btn-gold whitespace-nowrap"> S'inscrire </button>
        </form>
        <p class="text-xs text-charbon mt-4">
          Pas de spam. Vous pouvez vous desinscrire a tout moment.
        </p>
      </div>
    </div>
  </section>

  <!-- Topics Section -->
  <section class="py-16 md:py-20 section-creme">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <div class="text-center mb-12">
          <span class="text-elegant-caps text-or tracking-widest mb-4 block">Explorer</span>
          <h2 class="section-title">
            Sujets populaires
          </h2>
          <div class="separator-gold-center mt-6 mb-6"></div>
        </div>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
          <a
            href="/blog/pourquoi-site-web-commerce"
            class="card-elegant hover:scale-[1.02] transition-transform text-center group"
          >
            <div class="icon-container icon-container-lg mx-auto mb-3 group-hover:bg-or/20 transition-colors">
              <Icon name="storefront" class="icon-gold" size={24} />
            </div>
            <div class="font-serif font-semibold text-noir text-sm">Commerce local</div>
          </a>
          <a
            href="/blog/seo-local-saint-etienne"
            class="card-elegant hover:scale-[1.02] transition-transform text-center group"
          >
            <div class="icon-container icon-container-lg mx-auto mb-3 group-hover:bg-or/20 transition-colors">
              <Icon name="search" class="icon-gold" size={24} />
            </div>
            <div class="font-serif font-semibold text-noir text-sm">SEO Local</div>
          </a>
          <a
            href="/blog/combien-coute-site-web"
            class="card-elegant hover:scale-[1.02] transition-transform text-center group"
          >
            <div class="icon-container icon-container-lg mx-auto mb-3 group-hover:bg-or/20 transition-colors">
              <Icon name="price-tag" class="icon-gold" size={24} />
            </div>
            <div class="font-serif font-semibold text-noir text-sm">Tarifs & Budget</div>
          </a>
          <a
            href="/blog"
            class="card-elegant hover:scale-[1.02] transition-transform text-center group"
          >
            <div class="icon-container icon-container-lg mx-auto mb-3 group-hover:bg-or/20 transition-colors">
              <Icon name="palette" class="icon-gold" size={24} />
            </div>
            <div class="font-serif font-semibold text-noir text-sm">Design Web</div>
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA -->
  <section class="py-16 md:py-24 section-white">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto text-center">
        <span class="text-elegant-caps text-or tracking-widest mb-4 block">Passez a l'action</span>
        <h2 class="section-title">
          Pret a passer a l'action ?
        </h2>
        <div class="separator-gold-center mt-6 mb-6"></div>
        <p class="section-subtitle mx-auto mb-12">
          Ces conseils vous ont convaincu ? Creons ensemble le site web qui fera decoller votre
          commerce a Saint-Etienne.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a href="/devis" class="btn-gold"> Obtenir un devis gratuit </a>
          <a href="/#contact" class="btn-secondary"> Discuter de mon projet </a>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
